<!DOCTYPE html>
<html lang="PT-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Ponte Literária | Página Inicial</title>

    <script src="./js/sessao.js"></script>

    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/viewArtigo.css">
    <link rel="stylesheet" href="./css/navbar.css">
    <link rel="icon" href="./assets/icon/favicon2.ico">
    <link rel="preconnect" href="https://fonts.gstatic.com">
</head>

<body onload="acao()">

    <header style="z-index: 3;">
      <div class="container">
        <img class="logotipo" src="./assets/imgs/logotipo-pl.png" alt="">
        <div  class="barra-pesquisa">
            <span>
                <img src="./assets/icon/lupa.png" alt="">
            </span>
            <input type="text" placeholder="Pesquise Aqui...">
          </div>
        <div class="boxLogin">
          <a>Entrar</a>
          <span>|</span>
          <a>Cadastre-se</a>
        </div>
      </div>
    </header>
    

    <div class="sideBar" style="z-index: 2;">
        <ul>
            <div class="topico-pagina">
                <img src="./assets/icon/home.png" alt="">
                <span>
                    <a href="./feed.html">
                        Página Inicial 
                    </a>
                </span>
                
            </div>
            <div class="topico-pagina">
                <img src="./assets/icon/projeto.png" alt="">
                <span>
                    <a href="./index.html">
                        Projeto
                    </a>
                </span>
            </div>
            <div class="topico-pagina">
                <img src="./assets/icon/usuario.png" alt="">
                <span>
                    <a href="./perfil.html">
                        Perfil
                    </a>
                </span>
            </div>
            
            
            <!-- <div class="topico-pagina"> -->
<!--                 
                <span id="assunto">
                    Assunto
                </span>
            </div> -->

            <!-- <li>
                <input type="checkbox">
                <span>Comédia</span>
            </li>
            <li>
                <input type="checkbox">
                <span>Distopia</span>
            </li>
            <li>
                <input type="checkbox">
                <span>Fantasia</span>
            </li>
            <li>
                <input type="checkbox">
                <span>Poesia</span>
            </li>
            <li>
                <input type="checkbox">
                <span>Romance</span>
            </li>
            <li>
                <input type="checkbox">
                <span>Terror</span>
            </li> -->

            
            <div class="topico-pagina">
                <img src="./assets/icon/logout.png" alt="">
                
                    <a href="./index.html">
                        Sair
                    </a>
                
            </div>
        </ul>
    </div>

    <!-- corpo do feed -->

    <section class="sessaoCriacaoArtigo">
        <a onclick="voltarPagina()" style="position: fixed; left: 15rem; top: 8rem; padding: 1rem;">
            <img src="./assets/icon/voltar.png" style="height: 2.5rem;" alt="">
        </a>
        <div class="container" >
            <form action="" class="formularioCriacaoArtigo">
                <input type="text" placeholder="Digite um Titulo" id="tituloCriacaoArtigo" required>
                <textarea name="" id="criacaoArtigo" required></textarea>
                <button id="botaoArtigo" type="button" onclick="acaoPostagem()">
                    Publicar
                </button>
            </form>
            </div>
    </section>
    
  </body>
<script src="./js/navegacaoPagina.js"></script>
<script src="./js/postagem.js"></script>
<script>
    const params = new URLSearchParams(window.location.search);
    const idPostagem = params.get('id')
    function acao (){
        
        if( params.get('acao') == 'edit'){
            fetch(`post/view/${idPostagem}`, {cache: 'no-store'}).then(function (resposta) {
                if(resposta.ok) {
                    console.log(resposta)
                    resposta.json().then(function (res){
                        console.log(res)
                        document.getElementById('tituloCriacaoArtigo').value = res[0].tituloPostagem
                        document.getElementById('criacaoArtigo').value = res[0].conteudoPostagem
                        
                    })
                    document.getElementById('botaoArtigo').innerText = 'Editar'
            }else {
                    document.getElementById("visualizacaoArtigo").innerHTML =`<p style="text-align:center; margin: auto;">Erro ao mostrar artigo</p>`
                }
            })

        }
    }

    function acaoPostagem(){
        
        
        if(params.get('acao') == 'edit'){
            
            editarPostagem(sessionStorage.ID_USUARIO, idPostagem)
        }else{
            
            criarPostagem(sessionStorage.ID_USUARIO)
        }
    }


</script>
</html>